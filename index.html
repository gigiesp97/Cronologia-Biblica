<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cronologia Biblica Interattiva</title>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Fauna+One&display=swap');
        
        .serif-title { font-family: 'Cinzel', serif; }
        .serif-body { font-family: 'Fauna One', serif; }
        
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: #fdfaf3; }
        .viewport { width: 100vw; height: 100vh; position: relative; cursor: grab; }
        .viewport:active { cursor: grabbing; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        .connector-line { position: absolute; left: 50%; transform: translateX(-50%); z-index: 10; }

        /* Animazioni */
        .animate-in { animation: zoomIn 0.3s ease-out; }
        @keyframes zoomIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect, useMemo } = React;

        // --- DATI PERSONAGGI (Dal tuo App.tsx) ---
        const personaggi = [
            { nome: 'Adamo', nascita: -4026, morte: -3096, color: '#8b4513', cat: 'patriarca', desc: 'Il primo uomo creato da Dio.' },
            { nome: 'Eva', nascita: -4026, morte: -3096, color: '#a0522d', cat: 'storico', desc: 'La prima donna, madre di tutti i viventi.' },
            { nome: 'Caino', nascita: -3900, morte: -3100, color: '#4b5563', cat: 'storico', desc: 'Primo figlio di Adamo ed Eva, agricoltore.' },
            { nome: 'Abele', nascita: -3898, morte: -3700, color: '#64748b', cat: 'storico', desc: 'Secondo figlio di Adamo, pastore fedele ucciso dal fratello.' },
            { nome: 'Set', nascita: -3896, morte: -2984, color: '#8c6d31', cat: 'patriarca', desc: 'Figlio di Adamo nato dopo la morte di Abele.' },
            { nome: 'Enoc', nascita: -3404, morte: -3039, color: '#0ea5e9', cat: 'profeta', desc: 'Camminò con il vero Dio e profetizzò il giudizio.' },
            { nome: 'Matusalemme', nascita: -3339, morte: -2370, color: '#475569', cat: 'patriarca', desc: 'L\'uomo più longevo menzionato nella Bibbia (969 anni).' },
            { nome: 'Noè', nascita: -2970, morte: -2020, color: '#4682b4', cat: 'patriarca', desc: 'Costruttore dell\'arca e sopravvissuto al Diluvio.' },
            { nome: 'Abraamo', nascita: -2018, morte: -1843, color: '#b8860b', cat: 'patriarca', desc: 'Padre di molti popoli e amico di Geova.' },
            { nome: 'Sara', nascita: -2008, morte: -1881, color: '#be185d', cat: 'storico', desc: 'Moglie di Abraamo e madre di Isacco.' },
            { nome: 'Ismaele', nascita: -1932, morte: -1795, color: '#7c2d12', cat: 'storico', desc: 'Primo figlio di Abraamo avuto da Agar.' },
            { nome: 'Isacco', nascita: -1918, morte: -1738, color: '#daa520', cat: 'patriarca', desc: 'Figlio della promessa, padre di Giacobbe ed Esaù.' },
            { nome: 'Giacobbe', nascita: -1858, morte: -1711, color: '#cd853f', cat: 'patriarca', desc: 'Padre delle 12 tribù d\'Israele.' },
            { nome: 'Giuseppe', nascita: -1767, morte: -1657, color: '#d2691e', cat: 'storico', desc: 'Venduto in Egitto, divenne primo ministro del Faraone.' },
            { nome: 'Mosè', nascita: -1593, morte: -1473, color: '#2f4f4f', cat: 'profeta', desc: 'Liberatore d\'Israele e mediatore della Legge.' },
            { nome: 'Aronne', nascita: -1597, morte: -1474, color: '#708090', cat: 'sacerdote', desc: 'Primo Sommo Sacerdote d\'Israele.' },
            { nome: 'Miriam', nascita: -1600, morte: -1474, color: '#9d174d', cat: 'storico', desc: 'Sorella di Mosè e Aronne, profetessa in Israele.' },
            { nome: 'Giosuè', nascita: -1550, morte: -1440, color: '#556b2f', cat: 'giudice', desc: 'Successore di Mosè, guidò Israele in Canaan.' },
            { nome: 'Sansone', nascita: -1150, morte: -1070, color: '#a0522d', cat: 'giudice', desc: 'Uomo dalla forza prodigiosa donata da Dio.' },
            { nome: 'Samuele', nascita: -1150, morte: -1078, color: '#483d8b', cat: 'profeta', desc: 'Ultimo dei giudici e primo dei grandi profeti.' },
            { nome: 'Davide', nascita: -1107, morte: -1037, color: '#c5a059', cat: 're', desc: 'Il re pastore, autore di molti Salmi e antenato del Messia.' },
            { nome: 'Salomone', nascita: -1050, morte: -998, color: '#daa520', cat: 're', desc: 'Il re più saggio, costruttore del Tempio di Gerusalemme.' },
            { nome: 'Giosia', nascita: -667, morte: -629, color: '#483d8b', cat: 're', desc: 'Giovane re che restaurò la pura adorazione in Giuda.' },
            { nome: 'Elia', nascita: -910, morte: -850, color: '#ff4500', cat: 'profeta', desc: 'Profeta zelante che sfidò l\'adorazione di Baal.' },
            { nome: 'Daniele', nascita: -630, morte: -530, color: '#8a2be2', cat: 'profeta', desc: 'Fedele a Babilonia, interprete di sogni e visioni divine.' },
            { nome: 'Gesù', nascita: -2, morte: 33, color: '#800000', cat: 're', desc: 'Il Figlio di Dio, Messia promesso e Salvatore.' },
            { nome: 'Pietro', nascita: 1, morte: 67, color: '#4682b4', cat: 'apostolo', desc: 'L\'apostolo Simone detto Pietro, pilastro della congregazione.' },
            { nome: 'Paolo', nascita: 5, morte: 65, color: '#4b0082', cat: 'apostolo', desc: 'Saulo di Tarso, l\'apostolo delle nazioni e scrittore biblico.' },
            { nome: 'Giovanni', nascita: 6, morte: 100, color: '#008b8b', cat: 'apostolo', desc: 'L\'apostolo amato, autore del quarto Vangelo e di Rivelazione.' },
            { nome: 'Maria', nascita: -18, morte: 45, color: '#be185d', cat: 'storico', desc: 'Madre terrena di Gesù.' },
            { nome: 'Stefano', nascita: 5, morte: 34, color: '#cd5c5c', cat: 'storico', desc: 'Il primo martire cristiano per la fede in Gesù.' },
        ];

        // --- DATI EVENTI (Dal tuo data.ts) ---
        const timelineData = [
            { id: 'b-gen', data: '1513', era: 'a.E.V.', anno: 1513, avvenimento: 'Stesura di Genesi', tipo: 'libro', autore: 'Mosè' },
            { id: 'b-exo', data: '1512', era: 'a.E.V.', anno: 1512, avvenimento: 'Stesura di Esodo', tipo: 'libro', autore: 'Mosè' },
            { id: 'b-lev', data: '1512', era: 'a.E.V.', anno: 1512, avvenimento: 'Stesura di Levitico', tipo: 'libro', autore: 'Mosè' },
            { id: 'b-num', data: '1473', era: 'a.E.V.', anno: 1473, avvenimento: 'Stesura di Numeri', tipo: 'libro', autore: 'Mosè' },
            { id: 'b-deu', data: '1473', era: 'a.E.V.', anno: 1473, avvenimento: 'Stesura di Deuteronomio', tipo: 'libro', autore: 'Mosè' },
            { id: 'b-job', data: '1473', era: 'a.E.V.', anno: 1473, avvenimento: 'Stesura di Giobbe', tipo: 'libro', autore: 'Mosè' },
            { id: 'b-jos', data: '1450', era: 'a.E.V.', anno: 1450, avvenimento: 'Stesura di Giosuè', tipo: 'libro', autore: 'Giosuè' },
            { id: 'b-jud', data: '1100', era: 'a.E.V.', anno: 1100, avvenimento: 'Stesura di Giudici', tipo: 'libro', autore: 'Samuele' },
            { id: 'b-rut', data: '1090', era: 'a.E.V.', anno: 1090, avvenimento: 'Stesura di Rut', tipo: 'libro', autore: 'Samuele' },
            { id: 'b-1sa', data: '1078', era: 'a.E.V.', anno: 1078, avvenimento: 'Stesura di 1 Samuele', tipo: 'libro', autore: 'Samuele, Gad, Natan' },
            { id: 'b-2sa', data: '1040', era: 'a.E.V.', anno: 1040, avvenimento: 'Stesura di 2 Samuele', tipo: 'libro', autore: 'Gad, Natan' },
            { id: 'b-son', data: '1020', era: 'a.E.V.', anno: 1020, avvenimento: 'Stesura del Cantico dei Cantici', tipo: 'libro', autore: 'Salomone' },
            { id: 'b-ecc', data: '1000', era: 'a.E.V.', anno: 1000, avvenimento: 'Stesura di Ecclesiaste', tipo: 'libro', autore: 'Salomone' },
            { id: 'b-jon', data: '844', era: 'a.E.V.', anno: 844, avvenimento: 'Stesura di Giona', tipo: 'libro', autore: 'Giona' },
            { id: 'b-joe', data: '820', era: 'a.E.V.', anno: 820, avvenimento: 'Stesura di Gioele', tipo: 'libro', autore: 'Gioele' },
            { id: 'b-amo', data: '804', era: 'a.E.V.', anno: 804, avvenimento: 'Stesura di Amos', tipo: 'libro', autore: 'Amos' },
            { id: 'b-hos', data: '745', era: 'a.E.V.', anno: 745, avvenimento: 'Stesura di Osea', tipo: 'libro', autore: 'Osea' },
            { id: 'b-isa', data: '732', era: 'a.E.V.', anno: 732, avvenimento: 'Stesura di Isaia', tipo: 'libro', autore: 'Isaia' },
            { id: 'b-mic', data: '717', era: 'a.E.V.', anno: 717, avvenimento: 'Stesura di Michea', tipo: 'libro', autore: 'Michea' },
            { id: 'b-pro', data: '717', era: 'a.E.V.', anno: 717, avvenimento: 'Stesura di Proverbi', tipo: 'libro', autore: 'Salomone, Agur, Lemuel' },
            { id: 'b-zeph', data: '648', era: 'a.E.V.', anno: 648, avvenimento: 'Stesura di Sofonia', tipo: 'libro', autore: 'Sofonia' },
            { id: 'b-nah', data: '632', era: 'a.E.V.', anno: 632, avvenimento: 'Stesura di Naum', tipo: 'libro', autore: 'Naum' },
            { id: 'b-hab', data: '628', era: 'a.E.V.', anno: 628, avvenimento: 'Stesura di Abacuc', tipo: 'libro', autore: 'Abacuc' },
            { id: 'b-obad', data: '607', era: 'a.E.V.', anno: 607, avvenimento: 'Stesura di Abdia', tipo: 'libro', autore: 'Abdia' },
            { id: 'b-lam', data: '607', era: 'a.E.V.', anno: 607, avvenimento: 'Stesura di Lamentazioni', tipo: 'libro', autore: 'Geremia' },
            { id: 'b-eze', data: '591', era: 'a.E.V.', anno: 591, avvenimento: 'Stesura di Ezechiele', tipo: 'libro', autore: 'Ezechiele' },
            { id: 'b-1ki', data: '580', era: 'a.E.V.', anno: 580, avvenimento: 'Stesura di 1 e 2 Re', tipo: 'libro', autore: 'Geremia' },
            { id: 'b-dan', data: '536', era: 'a.E.V.', anno: 536, avvenimento: 'Stesura di Daniele', tipo: 'libro', autore: 'Daniele' },
            { id: 'b-hag', data: '520', era: 'a.E.V.', anno: 520, avvenimento: 'Stesura di Aggeo', tipo: 'libro', autore: 'Aggeo' },
            { id: 'b-zec', data: '518', era: 'a.E.V.', anno: 518, avvenimento: 'Stesura di Zaccaria', tipo: 'libro', autore: 'Zaccaria' },
            { id: 'b-est', data: '475', era: 'a.E.V.', anno: 475, avvenimento: 'Stesura di Ester', tipo: 'libro', autore: 'Mardocheo' },
            { id: 'b-ezr', data: '460', era: 'a.E.V.', anno: 460, avvenimento: 'Stesura di Esdra', tipo: 'libro', autore: 'Esdra' },
            { id: 'b-1ch', data: '460', era: 'a.E.V.', anno: 460, avvenimento: 'Stesura di 1 e 2 Cronache', tipo: 'libro', autore: 'Esdra' },
            { id: 'b-psa', data: '460', era: 'a.E.V.', anno: 460, avvenimento: 'Stesura di Salmi', tipo: 'libro', autore: 'Davide, Mosè, figli di Core, ecc.' },
            { id: 'b-neh', data: '443', era: 'a.E.V.', anno: 443, avvenimento: 'Stesura di Neemia', tipo: 'libro', autore: 'Neemia' },
            { id: 'b-mal', data: '443', era: 'a.E.V.', anno: 443, avvenimento: 'Stesura di Malachia', tipo: 'libro', autore: 'Malachia' },
            { id: 'b-mat', data: '41', era: 'E.V.', anno: 41, avvenimento: 'Vangelo di Matteo', tipo: 'libro', autore: 'Matteo' },
            { id: 'b-rev', data: '96', era: 'E.V.', anno: 96, avvenimento: 'Rivelazione (Apocalisse)', tipo: 'libro', autore: 'Giovanni' },
            { id: 'ev1', data: '4026', era: 'a.E.V.', anno: 4026, avvenimento: 'Creazione di Adamo' },
            { id: 'ev3', data: '2370', era: 'a.E.V.', anno: 2370, avvenimento: 'Inizio del Diluvio universale' },
            { id: 'ev5', data: '1943', era: 'a.E.V.', anno: 1943, avvenimento: 'Patto Abraamico' },
            { id: 'ev9', data: '1513', era: 'a.E.V.', anno: 1513, avvenimento: 'Esodo dall’Egitto' },
            { id: 'ev13', data: '1070', era: 'a.E.V.', anno: 1070, avvenimento: 'Davide diventa re' },
            { id: 'ev18', data: '607', era: 'a.E.V.', anno: 607, avvenimento: 'Distruzione di Gerusalemme' },
            { id: 'ev24', data: '2', era: 'a.E.V.', anno: 2, avvenimento: 'Nascita di Gesù' },
            { id: 'ev33', data: '33', era: 'E.V.', anno: 33, avvenimento: 'Morte e Risurrezione di Gesù' }
        ];

        const getIcon = (cat) => {
            switch (cat) {
                case 're': return 'fa-crown';
                case 'sacerdote': return 'fa-fire-alt';
                case 'profeta': return 'fa-scroll';
                case 'patriarca': return 'fa-staff-snake';
                case 'giudice': return 'fa-balance-scale';
                case 'apostolo': return 'fa-map-location-dot';
                default: return 'fa-user-group';
            }
        };

        const App = () => {
            const [transform, setTransform] = useState({ x: 100, y: 0, scale: 0.4 });
            const [selectedPerson, setSelectedPerson] = useState(null);
            const isDragging = useRef(false);
            const lastMousePos = useRef({ x: 0, y: 0 });

            const { processedEvents, xMap, sortedYears } = useMemo(() => {
                const yearsSet = new Set();
                for (let y = -4100; y <= 200; y += 100) yearsSet.add(y);
                timelineData.forEach(e => yearsSet.add(e.era === 'a.E.V.' ? -e.anno : e.anno));
                personaggi.forEach(p => { yearsSet.add(p.nascita); yearsSet.add(p.morte); });
                const sorted = Array.from(yearsSet).sort((a, b) => a - b);
                
                let currentX = 0;
                const yearToX = {};
                sorted.forEach((y, i) => {
                    if (i > 0) {
                        const gap = (y - sorted[i-1]) * 35;
                        currentX += Math.max(gap, 600);
                    }
                    yearToX[y] = currentX;
                });

                const getX = (y) => {
                    if (yearToX[y] !== undefined) return yearToX[y];
                    const keys = sorted;
                    for (let i = 0; i < keys.length - 1; i++) {
                        if (y >= keys[i] && y <= keys[i+1]) {
                            const ratio = (y - keys[i]) / (keys[i+1] - keys[i]);
                            return yearToX[keys[i]] + ratio * (yearToX[keys[i+1]] - yearToX[keys[i]]);
                        }
                    }
                    return 0;
                };

                const eventsAtX = {};
                const events = timelineData.map(ev => {
                    const x = getX(ev.era === 'a.E.V.' ? -ev.anno : ev.anno);
                    eventsAtX[x] = (eventsAtX[x] || 0) + 1;
                    const y = ev.tipo === 'libro' ? -700 - (eventsAtX[x] * 200) : -250 - (eventsAtX[x] * 140);
                    return { ...ev, x, y };
                });

                return { processedEvents: events, xMap: getX, sortedYears: sorted };
            }, []);

            const getStickyX = (sx, ex, nome) => {
                const vLeft = -transform.x / transform.scale;
                const labelW = (100 + nome.length * 10) / transform.scale;
                return Math.max(0, Math.min(vLeft - sx + 20/transform.scale, (ex - sx) - labelW));
            };

            const handleMouseDown = (e) => {
                isDragging.current = true;
                lastMousePos.current = { x: e.clientX, y: e.clientY };
            };

            const handleMouseMove = (e) => {
                if (!isDragging.current) return;
                setTransform(p => ({ 
                    ...p, 
                    x: p.x + (e.clientX - lastMousePos.current.x), 
                    y: p.y + (e.clientY - lastMousePos.current.y) 
                }));
                lastMousePos.current = { x: e.clientX, y: e.clientY };
            };

            return (
                <div className="viewport" onMouseDown={handleMouseDown} onMouseMove={handleMouseMove} onMouseUp={()=>isDragging.current=false}>
                    
                    <header className="fixed top-0 left-0 z-[1000] p-6 pointer-events-none">
                        <div className="bg-white/80 backdrop-blur shadow-2xl p-6 rounded-3xl border-2 border-amber-200 pointer-events-auto">
                            <h1 className="text-4xl font-bold serif-title text-amber-900 uppercase">Cronologia Biblica</h1>
                            <p className="text-xs tracking-widest font-bold text-amber-600 uppercase mt-1">Interattiva</p>
                        </div>
                    </header>

                    <div style={{ 
                        position: 'absolute', 
                        transform: `translate(${transform.x}px, ${window.innerHeight/2 + transform.y}px) scale(${transform.scale})`,
                        transformOrigin: '0 0'
                    }}>
                        {/* Linea temporale centrale */}
                        <div className="absolute h-16 bg-gradient-to-r from-amber-700 via-amber-500 to-amber-800 rounded-full shadow-2xl" 
                             style={{ width: 100000, top: -8, left: -2000, zIndex: 100 }} />

                        {/* Griglia Anni */}
                        {sortedYears.filter(y => y % 100 === 0).map(y => (
                            <div key={y} className="absolute flex flex-col items-center" style={{ left: xMap(y), top: 50 }}>
                                <div className="w-1 h-12 bg-amber-400 rounded-full mb-4" />
                                <div className="bg-white/90 p-4 rounded-2xl border-2 border-amber-100 shadow-xl">
                                    <span className="text-6xl font-black serif-title text-amber-800">{Math.abs(y)}</span>
                                    <div className="text-xl font-bold text-amber-500 text-center uppercase">{y < 0 ? 'a.E.V.' : 'E.V.'}</div>
                                </div>
                            </div>
                        ))}

                        {/* Personaggi */}
                        {personaggi.map((p, i) => {
                            const sx = xMap(p.nascita);
                            const ex = xMap(p.morte);
                            const y = 250 + (i % 12 * 90);
                            return (
                                <div key={p.nome+i} onClick={()=>setSelectedPerson(p)}
                                     className="absolute h-20 rounded-full border-4 border-white shadow-xl cursor-pointer hover:scale-105 transition-transform"
                                     style={{ left: sx, top: y, width: Math.max(ex-sx, 250), backgroundColor: p.color, zIndex: 50 }}>
                                    <div className="flex items-center h-full px-6" style={{ transform: `translateX(${getStickyX(sx, ex, p.nome)}px)` }}>
                                        <i className={`fa-solid ${getIcon(p.cat)} text-white text-2xl mr-4`} />
                                        <span className="text-white text-2xl font-bold serif-title uppercase whitespace-nowrap">{p.nome}</span>
                                    </div>
                                </div>
                            );
                        })}

                        {/* Eventi e Libri */}
                        {processedEvents.map(ev => (
                            <div key={ev.id} className="absolute" style={{ left: ev.x, top: ev.y, zIndex: 110 }}>
                                <div className="connector-line bg-amber-300" style={{ 
                                    width: ev.tipo === 'libro' ? 8 : 4,
                                    height: Math.abs(ev.y),
                                    top: ev.y < 0 ? '100%' : 'auto',
                                    bottom: ev.y > 0 ? '100%' : 'auto'
                                }} />
                                <div className={`p-8 rounded-[2.5rem] shadow-2xl border-4 transform -translate-x-1/2 ${ev.tipo === 'libro' ? 'bg-amber-800 text-amber-50 border-amber-400 w-[450px]' : 'bg-white text-amber-950 border-amber-100 w-[350px]'}`}>
                                    <div className="text-sm font-black text-amber-400 uppercase tracking-widest mb-2">{ev.data} {ev.era}</div>
                                    <div className="text-3xl font-bold serif-title leading-tight">{ev.avvenimento}</div>
                                    {ev.autore && <div className="mt-4 text-lg italic border-t border-amber-600/30 pt-4"><i className="fa-solid fa-pen-nib mr-2"/>{ev.autore}</div>}
                                </div>
                            </div>
                        ))}
                    </div>

                    {/* Modal Personaggio */}
                    {selectedPerson && (
                        <div className="fixed inset-0 z-[2000] flex items-center justify-center p-6 bg-amber-950/40 backdrop-blur-xl" onClick={()=>setSelectedPerson(null)}>
                            <div className="bg-[#fdfaf3] max-w-2xl w-full rounded-[4rem] p-12 shadow-full animate-in border-8 border-amber-200" onClick={e=>e.stopPropagation()}>
                                <div className="text-center">
                                    <div className="w-32 h-32 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-6 text-6xl text-amber-700 shadow-inner">
                                        <i className={`fa-solid ${getIcon(selectedPerson.cat)}`} />
                                    </div>
                                    <h2 className="text-6xl font-bold serif-title text-amber-900">{selectedPerson.nome}</h2>
                                    <p className="text-amber-600 font-black uppercase tracking-widest mt-2 mb-8">{selectedPerson.cat}</p>
                                    <div className="bg-white p-8 rounded-3xl shadow-inner italic text-3xl serif-body text-amber-950">
                                        "{selectedPerson.desc}"
                                    </div>
                                    <button onClick={()=>setSelectedPerson(null)} className="mt-10 w-full bg-amber-800 text-white py-6 rounded-full text-2xl font-bold shadow-lg">CHIUDI</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
